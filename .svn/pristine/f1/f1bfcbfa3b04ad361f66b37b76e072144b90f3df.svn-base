(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{373:function(t,e,o){},409:function(t,e,o){"use strict";o.r(e);var i=o(4),s=o(3),n=o(13),a=o(2),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},c=(i.a,s.a,n.a,r({},Object(a.mapState)({user:function(t){return t.glb.user},userInfo:function(t){return t.glb.userInfo}}),{validUser:function(){return this.userInfo?this.userInfo:this.user},codeLock:function(){var t=/^[1][3,4,5,7,8][0-9]{9}$/;return console.log(t.test(this.mobile)),!this.mobile||!t.test(this.mobile)||this.time>0},formCheck:function(){return!(!this.mobile||!/^[1][3,4,5,7,8][0-9]{9}$/.test(this.mobile))&&!!this.code}}),Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t}),u=-1,l={name:"mobile",components:{Cell:i.a,Group:s.a,XInput:n.a},data:function(){return{mobile:"",code:"",time:0}},computed:c({},Object(a.mapState)({user:function(t){return t.glb.user},userInfo:function(t){return t.glb.userInfo}}),{validUser:function(){return this.userInfo?this.userInfo:this.user},codeLock:function(){var t=/^[1][3,4,5,7,8][0-9]{9}$/;return console.log(t.test(this.mobile)),!this.mobile||!t.test(this.mobile)||this.time>0},formCheck:function(){return!(!this.mobile||!/^[1][3,4,5,7,8][0-9]{9}$/.test(this.mobile))&&!!this.code}}),methods:{showLoading:function(){this.$store.commit("updateLoadingStatus",{isLoading:!0})},hideLoading:function(t){this.$store.commit("updateLoadingStatus",{isLoading:!1}),2==t?this.$store.commit("updateWarnToastStatus"):this.$store.commit("updateToastStatus")},sendCode:function(){this.codeLock||(this.codeLock||(this.time=60,this.clock()),this.$http({url:"WxSms/send",method:"post",data:{mobile:this.mobile}}).then(function(t){t.data.statusCode}))},checkCode:function(){var t=this;this.showLoading(),this.$http({url:"WxSms/check",method:"post",data:{mobile:this.mobile,code:this.code}}).then(function(e){1==e.data.statusCode&&t.save()})},clock:function(){var t=this;u=setTimeout(function(){t.time--,t.time>0&&t.clock()},1e3)},save:function(){var t=this;this.$http({url:"WxUser/updateUserInfo",method:"post",data:{mobile:this.mobile}}).then(function(e){if(1==e.data.statusCode){if(!t.user.mobile){var o=_.cloneDeep(t.user);o.mobile=t.mobile,t.$store.commit("updateUserStatus",o)}t.hideLoading(),t.loadUser(1)}})},submit:function(){this.formCheck&&this.checkCode()},loadUser:function(t){var e=this;this.showLoading(),this.$http({url:"WxUser/selectUserInfo",method:"post",data:{}}).then(function(o){1==o.data.statusCode&&(e.$store.commit("updateUserInfoStatus",o.data.data),e.$store.commit("updateLoadingStatus",{isLoading:!1}),1==t&&e.$router.go(-1))})}},created:function(){this.userInfo||this.loadUser()},mounted:function(){},destroyed:function(){clearTimeout(u)}},d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"mobile_page"},[o("group",{attrs:{gutter:0}},[t.validUser.pwdMobile?o("cell",{attrs:{"is-type":"china-mobile","text-align":"right",title:"原手机号"}},[t._v(t._s(t.validUser.pwdMobile))]):t._e(),t._v(" "),o("x-input",{attrs:{"is-type":"china-mobile","text-align":"right",title:"手机号"},model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}}),t._v(" "),o("x-input",{attrs:{max:6,"text-align":"right","show-clear":!1,title:"验证码"},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}},[o("div",{staticClass:"mobile_code_btn",class:{mobile_code_btn_active:!t.codeLock},attrs:{slot:"right"},on:{click:t.sendCode},slot:"right"},[t._v("\n                获取验证码"),t.codeLock&&t.time>0?o("span",[t._v("("+t._s(t.time)+"s)")]):t._e()])])],1),t._v(" "),o("div",{staticClass:"sub_btn",class:{sub_btn_disabled:!t.formCheck},staticStyle:{"margin-top":"0.85rem"},on:{click:t.submit}},[t._v("保存")])],1)};d._withStripped=!0;var h=o(1),m=!1;var f=function(t){m||o(373)},b=Object(h.a)(l,d,[],!1,f,null,null);b.options.__file="src/pages/index/home/views/mobile.vue";e.default=b.exports}}]);
//# sourceMappingURL=19.js.map